"""Game progression steps and execution"""

import time
import threading
from macros import *


def get_game_steps():
    """Get the complete list of game progression steps
    
    Returns:
        list: List of (description, function, coords, sleep_duration) tuples
    """
    steps = [
        ('Login', tap_macro, (640, 560), 5),
        ('Guest Account', tap_macro, (840, 285), 6),
        ('Confirm', tap_macro, (895, 520), 10),
        ('Confirm Guest', tap_macro, (630, 615), 16),
        ('Confirm Server', tap_macro, (625, 495), 5),
        ('Choose Voice', tap_macro, (625, 360), 3),
        ('Confirm Voice', tap_macro, (625, 495), 10),
        ('Confirm Download', tap_macro, (860, 500), 130),
        ('Settings', tap_macro, (1205, 560), 10),
        ('Choose Detail 1', tap_macro, (1020, 275), 2),
        ('Low Detail 1', tap_macro, (1030, 380), 1),
        ('Choose Detail 2', tap_macro, (1020, 330), 2),
        ('Low Detail 2', tap_macro, (1030, 430), 1),    
        ('Choose Detail 3', tap_macro, (1020, 385), 2),
        ('Low Detail 3', tap_macro, (1030, 485), 1),
        ('Choose Detail 4', tap_macro, (1020, 440), 2),
        ('Low Detail 4', tap_macro, (1030, 540), 1),
        ('Choose Detail 5', tap_macro, (1020, 495), 2),
        ('Low Detail 5', tap_macro, (1030, 595), 3),
        ('Apply', tap_macro, (1120, 645), 5),
        ('Sound', tap_macro, (60, 235), 6),
        ('Mute', tap_macro, (1200, 165), 3),
        ('Close Settings', tap_macro, (1200, 60), 10),

        ('Global', tap_macro, (1, 1), 8),
        ('Global', tap_macro, (1, 1), 2),
        ('Skip Video', tap_macro, (1155, 45), 5),
        ('Skip Confirm', tap_macro, (849, 459), 8),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 16000), 17),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 7000), 10),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 3500), 6),

        #Battle Started First
        ('Global', tap_macro, (1, 1), 4),
        ('Global', tap_macro, (1, 1), 4),
        ('First Step', swipe_macro, (787, 577, 900, 365, 1500), 8),
        ('Global', tap_macro, (1, 1), 5),
        ('Global', tap_macro, (1, 1), 3),
        ('Global', tap_macro, (1, 1), 4),
        ('Global', tap_macro, (1, 1), 4),
        ('Global', tap_macro, (1, 1), 5),
        ('Second Step', swipe_macro, (901, 584, 886, 365, 1500), 5),
        ('Global', tap_macro, (1, 1), 5),
        ('R', swipe_macro, (787, 577, 900, 365, 1500), 8),
        ('Global', tap_macro, (1, 1), 5),
        ('Global', tap_macro, (1, 1), 5), 
        ('Skip Turn', tap_macro, (1142, 623), 10),
        ('Center Skill', swipe_macro, (640, 594, 993, 378, 1500 ), 2),
        ('Follow Skill', swipe_macro, (720, 592, 993, 378, 1500), 2),
        ('Center Skill', swipe_macro, (640, 594, 993, 378, 1500), 2),
        ('Follow Skill', swipe_macro, (720, 592, 993, 378, 1500), 2),
        ('Center Skill', swipe_macro, (640, 594, 993, 378, 1500), 2),
        ('Skip Turn', tap_macro, (1142, 623), 8),
        ('Center Skill', swipe_macro, (640, 594, 735, 333, 1500), 2),
        ('Follow Skill', swipe_macro, (720, 592, 735, 333, 1500), 2),
        ('Center Skill', swipe_macro, (640, 594, 735, 333, 1500), 8),
    
        ('3x', swipe_macro, (1232, 233, 1232, 333, 9000), 10),
        ('Global', tap_macro, (660, 1), 8),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 3000), 5),
        ('Global', tap_macro, (660, 1), 10),
        ('Global', tap_macro, (660, 1), 5),
        ('Center Skill', swipe_macro, (640, 594, 914, 405, 1500), 7),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Tutorial Skill', swipe_macro, (917, 623, 914, 405, 1500), 5),
        ('Follow Skill', swipe_macro, (720, 592, 914, 405, 1500), 7),
        ('Battle Continue', tap_macro, (1140, 667), 7) ,
        ('3x', swipe_macro, (1232, 233, 1232, 333, 9000), 10),
        ('Click Name', tap_macro, (640, 333), 3),
        ('Input Name', "input_name", None, 3),
        ('Confirm Name', tap_macro, (648, 478), 3),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 16000), 18  ),
        ('Battle Continue', tap_macro, (1140, 667), 6),

        # Prologue 2
        ('Prologue 2', tap_macro, (687, 361), 4),
        ('Battle Continue', tap_macro, (1140, 667), 6),
        ('Battle Continue', tap_macro, (1140, 667), 6),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 15000), 16),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 3000), 5),
        ('Global', tap_macro, (660, 1), 3),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 4000), 7),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 814, 397, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 3),
        ('Follow Skill left', swipe_macro, (547, 601, 814, 397, 1500), 4),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 10),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 814, 397, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 814, 397, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 8),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 814, 397, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 814, 397, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 814, 397, 1500), 7),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Skip Turn', tap_macro, (1142, 623), 8),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 3),
        ('Center Skill', swipe_macro, (640, 594, 914, 405, 1500), 7),
        ('Follow Skill', swipe_macro, (720, 592, 914, 405, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 914, 405, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 8),
        ('Center Skill', swipe_macro, (640, 594, 993, 378, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 993, 378, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 993, 378, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 993, 378, 1500), 10),
        ('Battle Continue', tap_macro, (1140, 667), 5),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 4000), 8),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 4000), 10),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 2000), 6),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 3000), 5),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 4000), 25),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 6000), 13),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Center Skill', swipe_macro, (640, 594, 923, 237, 1500), 4),
        ('Follow Skill', swipe_macro, (720, 592, 923, 237, 1500), 4),
        ('Center Skill', swipe_macro, (640, 594, 923, 237, 1500), 6),
        ('Skip Turn', tap_macro, (1142, 623), 10),
        ('Center Skill', swipe_macro, (640, 594, 923, 237, 1500), 5),
        ('Center Skill', swipe_macro, (640, 594, 923, 237, 1500), 4),
        ('Follow Skill', swipe_macro, (720, 592, 923, 237, 1500), 4),
        ('Skip Turn', tap_macro, (1142, 623), 9),
        ('Skip Turn', tap_macro, (1142, 623), 6),
        ('Global', tap_macro, (660, 1), 2),
        ('Follow Skill', swipe_macro, (720, 592, 923, 237, 3000), 19),
        ('Global', tap_macro, (660, 1), 18),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 10),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 6),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 4000), 6),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 4000), 34),
        ('Battle Continue', tap_macro, (1140, 667), 6),

        # EP - 1
        ('Choose Stage', tap_macro, (645, 365), 4),
        ('Battle Continue', tap_macro, (1140, 667), 8),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 28000), 30),
        # ('3x', swipe_macro, (1232, 233, 1232, 333, 9000), 12),
        ('Battle Continue', tap_macro, (1140, 667), 6),
        ('Global', tap_macro, (660, 1), 8), 
        ('Summon - 1', tap_macro, (853, 660), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('Skip Video', tap_macro, (1155, 45), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Return', tap_macro, (51, 32), 5),
        
        # Ep - 2
        ('Choose Stage', tap_macro, (720, 365), 10),
        ('Choose Stage', tap_macro, (720, 365), 5),
        ('Global', tap_macro, (660, 1), 2),
        ('Battle Continue', tap_macro, (1140, 667), 6),
        ('Global', tap_macro, (660, 1), 3),
        ('Team Formation 1', tap_macro, (170, 350), 3),
        ('New Char 1', tap_macro, (785, 198), 3),
        ('Assign Team', tap_macro, (1140, 667), 4),
        ('Team Enter', tap_macro, (1140, 667), 18),
        ('Global', tap_macro, (660, 1), 2),
        ('Skip Video', tap_macro, (1155, 45), 5),
        ('Skip Confirm', tap_macro, (849, 459), 8),
        ('Menu', tap_macro, (1226, 39), 4),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 6),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 3),
        ('Ep - 2 Map 1', tap_macro, (838, 153), 12),
        ('Center Skill', swipe_macro, (640, 594, 795, 390, 1500), 6),
        ('Center Skill', swipe_macro, (640, 594, 795, 390, 1500), 5),
        ('Follow Skill', swipe_macro, (720, 592, 795, 390, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 795, 390, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 795, 390, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 795, 390, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 795, 390, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 795, 390, 1500), 5),
        ('Center Skill', swipe_macro, (640, 594, 1060, 418, 1500), 5),
        ('Skip Turn', tap_macro, (1142, 623), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Center Skill', swipe_macro, (640, 594, 1060, 418, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 1060, 418, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 1060, 418, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 8),
        ('Center Skill', swipe_macro, (640, 594, 1060, 418, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 1060, 418, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 1060, 418, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 1060, 418, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 1060, 418, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 1060, 418, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 1060, 418, 1500), 6),
        ('Battle Continue', tap_macro, (1140, 667), 6),
        
        ('Next Map', tap_macro, (1015, 367), 6),
        ('Rest Free', tap_macro, (420, 536), 10),
        ('Rest Confirm', tap_macro, (896, 486), 8),
        ('Rest Leave', tap_macro, (1140, 667), 4),

        ('Next Map', tap_macro, (1015, 367), 12),
        ('Global', tap_macro, (660, 1), 3),
        ('Tut 1', tap_macro, (803, 619), 2),
        ('Tut Explore', tap_macro, (947, 486), 5),
        ('Tut 1', tap_macro, (803, 619), 3),
        ('Up Tut', tap_macro, (803, 377), 3),
        ('Global', tap_macro, (660, 1), 6),
        ('Global', tap_macro, (660, 1), 20),
        ('Global', tap_macro, (660, 1), 3),
        ('Char 2 Sword', tap_macro, (973, 376), 3),
        ('Battle Continue', tap_macro, (1140, 667), 10),
        ('Global', tap_macro, (660, 1), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Battle Continue', tap_macro, (1140, 667), 5),
        ('Next Map', tap_macro, (1015, 367), 12),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),

        ('Center Skill', swipe_macro, (640, 594, 801, 392, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 801, 392, 1500), 3),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 3),
        ('Tap Skill Upgrade', tap_macro, (325, 374), 4),
        ('Follow Skill', swipe_macro, (720, 592, 801, 392, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 801, 392, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 801, 392, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 801, 392, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 801, 392, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 801, 392, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 6),
        ('Center Skill', swipe_macro, (640, 594, 801, 392, 1500), 9),
        ('Follow Skill', swipe_macro, (720, 592, 801, 392, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 801, 392, 1500), 5),
        ('Center Skill', swipe_macro, (640, 594, 801, 392, 1500), 7),
        ('Battle Continue', tap_macro, (1140, 667), 6),

        ('Next Map', tap_macro, (1015, 367), 12),
        ('Global', tap_macro, (660, 1), 3),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 3000), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 10),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Menu', tap_macro, (1226, 39), 3),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 4 ),
        ('Attack', tap_macro, (1208, 624), 4),
        ('Attacking', tap_macro, (636, 591), 5),
        ('Global', tap_macro, (660, 1), 2),
        ('Center Skill', swipe_macro, (640, 594, 801, 420, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 801, 420, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 801, 420, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 15),
        ('Global', tap_macro, (660, 1), 2),
        ('Center Skill', swipe_macro, (640, 594, 801, 420, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 801, 420, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 801, 420, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 801, 420, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 801, 420, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 801, 420, 1500), 3),
        ('Follow Skill Left', swipe_macro, (547, 601, 801, 420, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 801, 420, 1500), 3),
        # ('Skip Turn', tap_macro, (1142, 623), 8),
        # ('Battle Continue', tap_macro, (1140, 667), 6),

        # 'EP 1 Char' - 122, 525
        # 'EP 2 Char' - 125, 594
        # 'EP 3 Char' - 128, 660

        # ('Ep 2 Skill', tap_macro, (125, 594), 2),
        # ('Ep 2 Skill Confirm', tap_macro, (801, 420), 13),
        ('Skip Turn', tap_macro, (1142, 623), 9),
        ('Center Skill', swipe_macro, (640, 594, 801, 420, 1500), 3),
        ('Follow Skill Left', swipe_macro, (547, 601, 801, 420, 1500), 4),
        ('Follow Skill left', swipe_macro, (547, 601, 801, 420, 1500), 4),
        ('Follow Skill left', swipe_macro, (547, 601, 801, 420, 1500), 4),
        ('Skip Turn', tap_macro, (1142, 623), 12),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 1),
        ('Battle Continue', tap_macro, (1140, 667), 5),

        # ('Menu', tap_macro, (1226, 39), 3),
        # ('Skip Menu', tap_macro, (1146, 39), 2),
        # ('Skip Confirm', tap_macro, (849, 459), 4),

        ('3x', swipe_macro, (1232, 233, 1232, 333, 8000), 10),

        ('Next Map', tap_macro, (1015, 367), 8),
        ('Menu', tap_macro, (1226, 39), 4),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 8),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 4),
        ('Global', tap_macro, (660, 1), 4),
        ('Center Message', tap_macro, (640, 615), 3),
        ('Center Message', tap_macro, (640, 615), 5),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 6),
        ('Global', tap_macro, (660, 1), 7),
        ('Global', tap_macro, (660, 1), 12),
        ('Choose Card', tap_macro, (628, 377), 8),
        ('Global', tap_macro, (660, 1), 6),
        ('Global', tap_macro, (660, 1), 4),
        ('Global', tap_macro, (660, 1), 5),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Battle Continue', tap_macro, (1140, 667),3),
        ('Next Map', tap_macro, (1015, 367), 12),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        
        ('Center Skill', swipe_macro, (640, 594, 934, 310, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 934, 310, 1500), 3),
        ('Follow Skill', swipe_macro, (750, 592, 934, 310, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 9),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Center Skill', swipe_macro, (640, 594, 934, 310, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 934, 310, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 3),
        ('Donot show again', tap_macro, (503, 360), 2),
        ('Confirm Donot show again', tap_macro, (844, 433), 20),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Skip Turn', tap_macro, (1142, 623), 9),
        ('Retry', tap_macro, (640, 657), 8),
        ('1st Skill', swipe_macro, (355, 626, 934, 310, 1500), 3),
        ('5th Skill', swipe_macro, (902, 616, 934, 310, 1500), 3),
        ('Follow Skill Left', swipe_macro, (537, 601, 934, 310, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 934, 310, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 934, 310, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 934, 310, 1500), 3),
        ('Follow Skill Left', swipe_macro, (527, 601, 934, 310, 1500), 8),
        ('Battle Continue', tap_macro, (1140, 667), 1),
        ('Battle Continue', tap_macro, (1140, 667), 8),
        ('Char Vest', tap_macro, (1064, 378), 2),
        ('Equip Vest', tap_macro, (1140, 667), 4),
        ('Battle Continue', tap_macro, (1140, 667), 3),
        ('Battle Continue', tap_macro, (1140, 667), 4),
        ('Battle Continue', tap_macro, (1140, 667), 4),
        ('Menu', tap_macro, (1226, 39), 3),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 4),

        ('Next Map', tap_macro, (1015, 367), 8),
        ('Menu', tap_macro, (1226, 39), 3),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 6),
        ('Menu', tap_macro, (1226, 39), 3),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 6),
        ('Examine 1', tap_macro, (741, 166), 4),
        ('Examine 2', tap_macro, (616, 366), 4),
        ('Examine 3', tap_macro, (848, 408), 4),
        ('Menu', tap_macro, (1226, 39), 3),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 6),
        ('Menu', tap_macro, (1226, 39), 3),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 6),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 6),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 12),
        # ('Ep 1 Skill', tap_macro, (122, 525), 2),
        # ('Ep 1 Skill Confirm', tap_macro, (926, 187), 11),
        ('Center Skill', swipe_macro, (640, 594, 926, 187, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 926, 187, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 5),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Follow Skill', swipe_macro, (720, 592, 926, 187, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 926, 187, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 926, 187, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 926, 187, 1500), 3),
        ('Follow Skill', swipe_macro, (720, 592, 926, 187, 1500), 3),
        ('Center Skill', swipe_macro, (640, 594, 926, 187, 1500), 3),
        ('Skip Turn', tap_macro, (1142, 623), 12),
        ('Menu', tap_macro, (1226, 39), 3),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 16),
        ('Battle Continue', tap_macro, (1140, 667), 6),
        ('Menu', tap_macro, (1226, 39), 3),
        ('Skip Menu', tap_macro, (1146, 39), 2),
        ('Skip Confirm', tap_macro, (849, 459), 5),
        ('Battle Continue', tap_macro, (1140, 667), 6),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 4),
        ('Next Map', tap_macro, (1015, 367), 7),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 4),
        ('Message Center', tap_macro, (640, 615), 2),
        ('Message Center', tap_macro, (640, 615), 6),
        ('Battle Continue', tap_macro, (1140, 667), 4),
        ('Global', tap_macro, (660, 1), 6),
        ('Battle Continue', tap_macro, (1140, 667), 8),
        ('Battle Continue', tap_macro, (1140, 667), 10),
        
        # Ep - 3
        ('Choose Stage', tap_macro, (630, 360), 3),
        ('Battle Continue', tap_macro, (1140, 667), 8),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 28000), 30),
        ('Battle Continue', tap_macro, (1140, 667), 10),
        ('Global', tap_macro, (660, 1), 2),
        ('Proceed with Tut', tap_macro, (619, 454), 7),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Missions', tap_macro, (1211, 117), 6), 
        ('Mission Right', tap_macro, (1211, 117), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('B1', tap_macro, (634, 362), 3),
        ('Battle Continue', tap_macro, (1140, 667), 2),
        ('Battle Continue', tap_macro, (1140, 667), 2),
        ('Battle Continue', tap_macro, (1140, 667), 6),
        ('Global', tap_macro, (660, 1), 2), 
        ('Data Center', tap_macro, (448, 538), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('Space', tap_macro, (1141, 663), 2),
        ('Space', tap_macro, (1141, 663), 3),
        ('Data Left', tap_macro, (145, 231), 3), 
        ('Global', tap_macro, (660, 1), 2),
        ('Space', tap_macro, (1141, 663), 2),
        ('Return', tap_macro, (51, 32), 3),
        ('Return', tap_macro, (51, 32), 3),
        ('Space', tap_macro, (1141, 663), 2),
        ('Space', tap_macro, (1141, 663), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Pet Required', tap_macro, (995, 292), 4),
        ('Assign Partner', tap_macro, (711, 344), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Space', tap_macro, (1141, 663), 3),
        ('Return', tap_macro, (51, 32), 3),
        ('Pet 2nd', tap_macro, (529, 442), 4), 
        ('Assign Partner', tap_macro, (711, 344), 4),
        ('Space', tap_macro, (1141, 663), 3),
        ('Return', tap_macro, (51, 32), 3),
        ('Pet 3rd',tap_macro, (787, 442), 2), # Issue
        ('Assign Partner', tap_macro, (711, 344), 4),
        ('Space', tap_macro, (1141, 663), 3),
        ('Battle Continue', tap_macro, (1140, 667), 13),
        ('Global', tap_macro, (660, 1), 2),
        ('Auto Fight', tap_macro, (1124, 40), 79),
        ('Battle Continue', tap_macro, (1140, 667), 5),

        # B2
        ('B2', tap_macro, (659, 357), 4),
        ('Space', tap_macro, (1141, 663), 3),
        ('Space', tap_macro, (1141, 663),105),
        ('Battle Continue', tap_macro, (1140, 667), 4),

        # B3
        ('B3', tap_macro, (660, 362), 4), 
        ('Space', tap_macro, (1141, 663), 3),
        ('Char Req', tap_macro, (470, 271), 4),
        ('Char Details', tap_macro, (771, 673), 5),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Space', tap_macro, (1141, 663), 3),   
        ('Global', tap_macro, (660, 1), 2),
        ('Auto Register', tap_macro, (1105, 604), 3),
        ('Space', tap_macro, (1141, 663), 3),
        ('Space', tap_macro, (1141, 663), 6),
        ('Global', tap_macro, (660, 1), 3),
        ('Global', tap_macro, (660, 1), 3),
        ('Return', tap_macro, (51, 32), 3),
        ('Another Char 3', tap_macro, (51, 274), 3),
        ('Space', tap_macro, (1141, 663), 3),
        ('Auto Register', tap_macro, (1105, 604), 3),
        ('Space', tap_macro, (1141, 663), 6),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 4),
        ('Another Char 2', tap_macro, (51, 193), 3),
        ('Space', tap_macro, (1141, 663), 3),
        ('Auto Register', tap_macro, (1105, 604), 3),
        ('Space', tap_macro, (1141, 663), 6),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 4),
        ('Return', tap_macro, (51, 32), 3),
        ('Return', tap_macro, (51, 32), 6),
        ('Return', tap_macro, (51, 32), 4),
        ('Space', tap_macro, (1141, 663), 93),
        ('Battle Continue', tap_macro, (1140, 667), 5),

        ('Proceed with Tut', tap_macro, (619, 454), 7),
        ('Global', tap_macro, (660, 1), 2),
        ('Missions', tap_macro, (1211, 117), 6),
        ('Mission Left', tap_macro, (294, 380), 4),
        
        # 4-1
        ('4-1', tap_macro, (644, 360), 3),
        ('Space', tap_macro, (1141, 663), 2),
        ('Battle Continue', tap_macro, (1140, 667), 8),
        ('3x', swipe_macro, (1232, 233, 1232, 333, 18000), 20),
        ('Space', tap_macro, (1141, 663), 4),
        ('Proceed with Tut', tap_macro, (619, 454), 8),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),

        # Chaos
        ('Chaos', tap_macro, (1212, 258), 6),
        ('Global', tap_macro, (660, 1), 2),
        ('Chaos Left', tap_macro, (294, 380), 4),
        ('Blue Pot', tap_macro, (295, 488), 4),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Global', tap_macro, (660, 1), 2),
        ('Space', tap_macro, (1141, 663), 6),
        ('Team Formation 1', tap_macro, (178, 345), 3),
        ('Char Details', tap_macro, (771, 673), 5),
        ('Char Partner', tap_macro, (190, 345), 3),
        ('Return', tap_macro, (51, 32), 4),
        ('Return', tap_macro, (51, 32), 3),
        ('Space', tap_macro, (1141, 663), 12),
        ('Research', tap_macro, (322, 366), 2),
        ('Space', tap_macro, (1141, 663), 5),
        ('Space', tap_macro, (1141, 663), 4),
        ('Space', tap_macro, (1141, 663), 6),

        # Blue Pot - 1
        ('Chaos Top Stage', tap_macro, (847, 162), 9),

    ]
    return steps


def execute_macro_steps(guest_data, steps, log_func, pause_event):
    """Execute macro steps for all accounts in parallel
    
    Args:
        guest_data: List of (instance_name, guest_name) tuples
        steps: List of macro steps to execute
        log_func: Logging function
        pause_event: Threading event for pause control
    """
    for log_text, action_func, coords, sleep_duration in steps:
        pause_event.wait()
        log_func(log_text)

        if action_func == "input_name":
            # Special case for name input
            for instance_name, guest_name in guest_data:
                pause_event.wait()
                input_macro(instance_name, guest_name)
                log_func(f"[{instance_name}] Input guest name: {guest_name}")
        else:
            # Normal actions with threading
            threads = []
            for instance_name, _ in guest_data:
                pause_event.wait()
                if coords is not None:
                    t = threading.Thread(target=action_func, args=(instance_name, *coords))
                else:
                    t = threading.Thread(target=action_func, args=(instance_name,))
                t.start()
                threads.append(t)

            # Wait for all threads
            for t in threads:
                t.join()

        # Sleep with pause checking
        for _ in range(sleep_duration):
            pause_event.wait()
            time.sleep(1)